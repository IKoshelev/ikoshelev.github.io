(this["webpackJsonpui-app-architecture-showcases"]=this["webpackJsonpui-app-architecture-showcases"]||[]).push([[0],{32:function(e,n,a){},38:function(e,n,a){},40:function(e,n,a){},41:function(e,n,a){},42:function(e,n,a){"use strict";a.r(n);var t,r=a(1),s=a.n(r),i=a(17),c=a.n(i),l=(a(32),a(5)),u=a(9),o=a(27),d=a(2),p=a.n(d),b=a(4),v=a(8),f=a(11),m=a(6),g=a(7),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(n){return setTimeout(n,e)}))};!function(e){e[e.base=0]="base",e[e.thridParty=1]="thridParty",e[e.assetProtection=2]="assetProtection"}(t||(t={}));var h,I,O=new(function(){function e(){Object(m.a)(this,e)}return Object(g.a)(e,[{key:"getAvaliableInsurancePlans",value:function(){var e=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getAvaliableInsurancePlans"),e.next=3,j(1500);case 3:return e.abrupt("return",[{type:t.base,description:"base plan",rate:.05},{type:t.thridParty,description:"3rd-party liability",rate:.05},{type:t.assetProtection,description:"asset protection",rate:.3}]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}()),w=a(14),y=a.n(w),P=a(12);!function(e){e.EUR="EUR",e.GBP="GBP",e.CHF="CHF"}(I||(I={}));var x=(h={},Object(P.a)(h,I.EUR,.93),Object(P.a)(h,I.GBP,.83),Object(P.a)(h,I.CHF,.97),h),D=new(function(){function e(){Object(m.a)(this,e)}return Object(g.a)(e,[{key:"getCurrencies",value:function(){var e=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getCurrencies"),e.next=3,j(1e3);case 3:return e.abrupt("return",[I.EUR,I.GBP,I.CHF]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getExchangeRate",value:function(){var e=Object(b.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getExchangeRate"),e.next=3,j(1e3);case 3:return e.abrupt("return",x[n]);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),e}()),S=[];function A(e){var n={isApproved:!0,expiration:e,approvalToken:Math.random().toString()};return S.push(n),n}var k=new(function(){function e(){Object(m.a)(this,e)}return Object(g.a)(e,[{key:"getMinimumPossibleDownpayment",value:function(){var e=Object(b.a)(p.a.mark((function e(n,a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getMinimumPossibleDownpayment"),e.next=3,j(1e3);case 3:if(!a.some((function(e){return e===t.assetProtection}))){e.next=5;break}return e.abrupt("return",n.basePriceUSD/10);case 5:return e.abrupt("return",n.basePriceUSD/5);case 6:case"end":return e.stop()}}),e)})));return function(n,a){return e.apply(this,arguments)}}()},{key:"getMinimumPossibleDownpaymentInForeignCurrency",value:function(){var e=Object(b.a)(p.a.mark((function e(n,a,t){var r,s,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getMinimumPossibleDownpaymentInForeignCurrency"),e.next=3,Promise.all([this.getMinimumPossibleDownpayment(n,a),D.getExchangeRate(t)]);case 3:return r=e.sent,s=Object(f.a)(r,2),i=s[0],c=s[1],e.abrupt("return",i*c);case 8:case"end":return e.stop()}}),e,this)})));return function(n,a,t){return e.apply(this,arguments)}}()},{key:"getApproval",value:function(){var e=Object(b.a)(p.a.mark((function e(n,a,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getApproval"),e.next=3,j(1e3);case 3:if(!(a.some((function(e){return e===t.assetProtection}))&&n.basePriceUSD/10<=r)){e.next=5;break}return e.abrupt("return",A());case 5:if(!(n.basePriceUSD/5<=r)){e.next=7;break}return e.abrupt("return",A(y()().add(15+30*Math.random(),"s").toDate()));case 7:return e.abrupt("return",{isApproved:!1,message:"Approval denied. Downpayment should be over 20% of base price (10% with 'asset protection' insurance)."});case 8:case"end":return e.stop()}}),e)})));return function(n,a,t){return e.apply(this,arguments)}}()},{key:"getApprovalWithForeignCurrency",value:function(){var e=Object(b.a)(p.a.mark((function e(n,a,t,r){var s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getApprovalWithForeignCurrency"),e.next=3,D.getExchangeRate(r);case 3:return s=e.sent,i=t/s+1,e.abrupt("return",this.getApproval(n,a,i));case 6:case"end":return e.stop()}}),e,this)})));return function(n,a,t,r){return e.apply(this,arguments)}}()},{key:"finalizeFinancing",value:function(){var e=Object(b.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call finalizeFinancing"),e.next=3,j(500);case 3:return e.abrupt("return",S.some((function(e){return e.approvalToken===n&&(!e.expiration||e.expiration>=new Date)})));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),e}()),C=a(3);function M(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=Object(C.a)(Object(C.a)({},e),{},{currentUnsavedValue:n});return a&&(t.message=void 0,t.isValid=!0),t}function N(e){for(var n=0,a=Object.entries(e);n<a.length;n++){var t=Object(f.a)(a[n],2);t[0];if(!0===t[1])return!0}return!1}var z=a(18),L=a.n(z),F=Object(v.b)(v.c,L.a);function V(e){var n=new Map,a=function(a){var t=n.get(a);if(t)return t;var r=e(a);return n.set(a,r),r};return a.cache=n,a}var E=a(15),R="Deal",U=function(){return{type:R,businessParams:{dealId:0,isDealFinalized:!1,downpayment:0,insurancePlansSelected:[],carModelSelected:void 0},isClosed:!1,isLoadingItemized:{},downplaymentInputState:(e={integer:!0,positive:!0},{currentUnsavedValue:void 0,message:void 0,isValid:!0,reuirments:null!==e&&void 0!==e?e:{integer:!1,positive:!1}}),insurancePlansAvailable:[],carModelsAvailable:[],messages:[]};var e},q=V((function(e){var n=Object(v.a)(T,(function(e){return e})),a=Object(v.a)(G,(function(e){return e})),t=Object(v.a)(K,(function(e){return e}));return Object(v.a)((function(n){return a(n,e)}),(function(a){return n(a,e)}),(function(n){return n.approvals.isLoading[e]}),F((function(t){return function(e,n,a){if(e.businessParams.isDealFinalized)return"deal-finalized";if(!n||!1===n.isApproved)return"no-approval";var t=n.expiration;if(!t)return"approval-perpetual";if(t<=a)return"approval-expired";return{approvalExpiresAt:t}}(a(t,e),n(t,e),t.clock.currentDate)}),(function(e){return e})),(function(t){return r=a(t,e),s=n(t,e),i=t.clock.currentDate,!1===r.businessParams.isDealFinalized&&(null===s||void 0===s?void 0:s.isApproved)&&(!s.expiration||s.expiration>=i);var r,s,i}),(function(e,n,a,r,s){return{deal:e,approval:n,isCurrentApprovalLoading:a,canRequestMinimumDownpayment:H(e.businessParams),finalPrice:B(e),generalValidation:t(e),dealProgressState:r,headerAdditionalDescription:J(e),canBeFinalized:s,isLoadingAny:N(e.isLoadingItemized),canRequestApproval:e.businessParams.carModelSelected&&!1===e.businessParams.isDealFinalized&&e.downplaymentInputState.isValid&&!1===t(e).downpaymentExceedsPrice}}))}));function H(e){return e.carModelSelected&&!1===e.isDealFinalized}var B=Object(E.a)("type",R,(function(e){var n,a=null===(n=e.businessParams.carModelSelected)||void 0===n?void 0:n.basePriceUSD;if(!a)return 0;var t=e.businessParams.insurancePlansSelected.map((function(e){return a*e.rate})).reduce((function(e,n){return e+n}),0);return a+t}));function K(e){return{downpaymentExceedsPrice:!!(e.businessParams.carModelSelected&&e.businessParams.downpayment>B(e))}}function W(e){if(!e.carModelSelected)throw new Error("Car model not selected.")}function G(e,n){return e.deals.deals.find((function(e){return e.businessParams.dealId===n}))}function T(e,n){var a=G(e,n);if(a)return function(e,n){var a,t,r=$(n).request;return null===(a=e.approvals[n.businessParams.dealId])||void 0===a||null===(t=a.filter((function(e){var n=e.request;return L()(n,r)})).sort((function(e,n){return n.timestamp.valueOf()-e.timestamp.valueOf()}))[0])||void 0===t?void 0:t.result}(e.approvals,a)}var J=Object(E.a)("type",R,(function(e){return""})),X=Object(E.a)("type",R,(function(e){return k.getMinimumPossibleDownpayment(e.businessParams.carModelSelected,e.businessParams.insurancePlansSelected.map((function(e){return e.type})))})),$=Object(E.a)("type",R,(function(e){W(e.businessParams);var n=[e.businessParams.carModelSelected,e.businessParams.insurancePlansSelected.map((function(e){return e.type})),e.businessParams.downpayment];return{request:n,makeCall:function(){return k.getApproval.apply(k,n)}}})),Q=Object(u.a)()({state:{approvals:{},isLoading:{}},reducers:{storeApprovalReqStatus:function(e,n,a){return e.approvals[n]||(e.approvals[n]=[]),e.approvals[n].push(a),e},setIsLoading:function(e,n,a){return e.isLoading[n]=a,e}},effects:function(e){return{requestApproval:function(n,a){return Object(b.a)(p.a.mark((function a(){var t,r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.approvals.setIsLoading(n.businessParams.dealId,!0),t=$(n),a.next=4,t.makeCall();case 4:r=a.sent,e.approvals.storeApprovalReqStatus(n.businessParams.dealId,{request:t.request,result:r,timestamp:new Date}),e.approvals.setIsLoading(n.businessParams.dealId,!1);case 7:case"end":return a.stop()}}),a)})))()}}}}),Y=new(function(){function e(){Object(m.a)(this,e)}return Object(g.a)(e,[{key:"getAvaliableCarModels",value:function(){var e=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server call getAvaliableCarModels"),e.next=3,j(500);case 3:return e.abrupt("return",[{id:1,description:"Hetman Speedster",basePriceUSD:1e5},{id:2,description:"Hetman Workhorse",basePriceUSD:26e3},{id:3,description:"Hetman Luxury",basePriceUSD:9e4}]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}()),Z=a(24),_=a.n(Z);function ee(e,n){return{guard:e,diff:n}}var ne="Deal;DealForeignCurrency",ae=function(){var e=U();return _()(e,{type:ne,currenciesAvailable:[],exchangeRate:1,businessParams:{foreignCuurencyHandlingCoeficient:1.02,downpaymentCurrency:I.EUR}})},te=function(e){return e.type===ne};function re(e,n){var a=e.deals.deals.find((function(e){return e.businessParams.dealId===n}));return function(e){if(!1===te(e))throw new Error("Deal with is ".concat(e.businessParams.dealId," was found, but has type: ").concat(e.type," instead of expected ").concat(ne))}(a),a}var se=V((function(e){var n=q(e);return Object(v.a)((function(e){var a=n(e);return function(e,n,a){if(!1===a(e[n]))throw new Error("Assertion failed")}(a,"deal",te),a}),(function(e){return Object(C.a)({},e)}))}));J.override(ne,(function(e){return"".concat(e.businessParams.downpaymentCurrency," ")})),B.override(ne,(function(e){var n=this.base(e)*e.businessParams.foreignCuurencyHandlingCoeficient*e.exchangeRate;return Math.round(n)})),X.override(ne,(function(e){return k.getMinimumPossibleDownpaymentInForeignCurrency(e.businessParams.carModelSelected,e.businessParams.insurancePlansSelected.map((function(e){return e.type})),e.businessParams.downpaymentCurrency)})),$.override(ne,(function(e){W(e.businessParams);var n=[e.businessParams.carModelSelected,e.businessParams.insurancePlansSelected.map((function(e){return e.type})),e.businessParams.downpayment,e.businessParams.downpaymentCurrency];return{request:n,makeCall:function(){return k.getApprovalWithForeignCurrency.apply(k,n)}}}));var ie=a(25),ce={nextDealId:1,deals:[],activeDealId:void 0,newDealIsLoading:!1},le=Object(u.a)()({state:ce,reducers:{set:function(e,n){return Object.assign(e,n),e},mergeWithGuard:function(e,n,a){var t=e.deals.find((function(e){return e.businessParams.dealId===n}));return function(e){if(!e)throw new Error("Assertion failed")}(a.guard(t)),Object(ie.merge)(t,a.diff),e},pushNewDeal:function(e,n){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.deals.push(n),a&&(e.activeDealId=n.businessParams.dealId),n.businessParams.carModelSelected=n.carModelsAvailable[0],e},removeDeal:function(e,n){if(n===e.activeDealId){var a,t,r,s=e.deals.findIndex((function(e){return e.businessParams.dealId===n})),i=null!==(a=null===(t=e.deals[s-1])||void 0===t?void 0:t.businessParams.dealId)&&void 0!==a?a:null===(r=e.deals[s+1])||void 0===r?void 0:r.businessParams.dealId;console.log(i),e.activeDealId=i}return e.deals=e.deals.filter((function(e){return e.businessParams.dealId!==n})),e},updateDownpaymentInputValue:function(e,n,a){var t=e.deals.find((function(e){return e.businessParams.dealId===n}));return t.downplaymentInputState=M(t.downplaymentInputState,a),e},tryCommitDownpaymentInputValue:function(e,n){var a,t=e.deals.find((function(e){return e.businessParams.dealId===n})),r=function(e,n,a){if(!e.currentUnsavedValue)return{newInputState:Object(C.a)(Object(C.a)({},e),{},{currentUnsavedValue:void 0,isValid:!0,message:void 0}),newModelState:n};var t=e.currentUnsavedValue;t=function(e){return e.replace("k","000").replace("K","000").replace("m","000000").replace("M","000000")}(t.trim());var r=Number(t);if(Number.isNaN(r)||!Number.isFinite(r))return{newInputState:Object(C.a)(Object(C.a)({},e),{},{isValid:!1,message:"Please enter a valid number"}),newModelState:n};if(e.reuirments.integer&&!Number.isInteger(r))return{newInputState:Object(C.a)(Object(C.a)({},e),{},{isValid:!1,message:"Please enter a valid integer"}),newModelState:n};if(e.reuirments.positive&&r<0)return{newInputState:Object(C.a)(Object(C.a)({},e),{},{isValid:!1,message:"Value must be positive"}),newModelState:n};var s=null===a||void 0===a?void 0:a(r);return s?{newInputState:Object(C.a)(Object(C.a)({},e),{},{isValid:!1,message:s}),newModelState:n}:{newInputState:Object(C.a)(Object(C.a)({},e),{},{currentUnsavedValue:void 0,isValid:!0,message:void 0}),newModelState:r}}(t.downplaymentInputState,t.businessParams.downpayment);return t.downplaymentInputState=r.newInputState,t.businessParams.downpayment=null!==(a=r.newModelState)&&void 0!==a?a:0,e},setInDeal:function(e,n,a){var t=e.deals.find((function(e){return e.businessParams.dealId===n}));return Object.assign(t,a),e},setIsLoadingItemized:function(e,n,a){var t=e.deals.find((function(e){return e.businessParams.dealId===n}));return Object.assign(t.isLoadingItemized,a),e},setInBusinessParams:function(e,n,a){var t=e.deals.find((function(e){return e.businessParams.dealId===n}));return Object.assign(t.businessParams,a),e}},effects:function(e){return{loadNewDeal:function(n,a){return Object(b.a)(p.a.mark((function n(){var t;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.deals.set({newDealIsLoading:!0}),(t=U()).businessParams.dealId=a.deals.nextDealId,e.deals.set({nextDealId:a.deals.nextDealId+1}),n.next=6,Promise.all([Y.getAvaliableCarModels().then((function(e){return t.carModelsAvailable=e})),O.getAvaliableInsurancePlans().then((function(e){return t.insurancePlansAvailable=e}))]);case 6:e.deals.pushNewDeal(t),e.deals.set({newDealIsLoading:!1});case 8:case"end":return n.stop()}}),n)})))()},loadNewDealForeignCurrency:function(n,a){return Object(b.a)(p.a.mark((function n(){var t;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.deals.set({newDealIsLoading:!0}),(t=ae()).businessParams.dealId=a.deals.nextDealId,e.deals.set({nextDealId:a.deals.nextDealId+1}),n.next=6,Promise.all([Y.getAvaliableCarModels().then((function(e){return t.carModelsAvailable=e})),O.getAvaliableInsurancePlans().then((function(e){return t.insurancePlansAvailable=e})),D.getCurrencies().then((function(e){return t.currenciesAvailable=e})),D.getExchangeRate(t.businessParams.downpaymentCurrency).then((function(e){return t.exchangeRate=e}))]);case 6:e.deals.pushNewDeal(t),e.deals.set({newDealIsLoading:!1});case 8:case"end":return n.stop()}}),n)})))()},reloadAvailableCarModels:function(n,a){return Object(b.a)(p.a.mark((function a(){var t;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.deals.setIsLoadingItemized(n,{carModelsAvailable:!0}),a.next=3,Y.getAvaliableCarModels();case 3:t=a.sent,e.deals.setInDeal(n,{carModelsAvailable:t}),e.deals.setIsLoadingItemized(n,{carModelsAvailable:!1});case 6:case"end":return a.stop()}}),a)})))()},reloadAvailableInsurancePlans:function(n,a){return Object(b.a)(p.a.mark((function a(){var t;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.deals.setIsLoadingItemized(n,{insurancePlansAvailable:!0}),a.next=3,O.getAvaliableInsurancePlans();case 3:t=a.sent,e.deals.setInDeal(n,{insurancePlansAvailable:t}),e.deals.setIsLoadingItemized(n,{insurancePlansAvailable:!1});case 6:case"end":return a.stop()}}),a)})))()},setMinimumPossibleDownpayment:function(n,a){return Object(b.a)(p.a.mark((function t(){var r,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.deals.setIsLoadingItemized(n,{downpayment:!0}),W((r=a.deals.deals.find((function(e){return e.businessParams.dealId===n}))).businessParams),t.next=5,X(r);case 5:s=t.sent,e.deals.setInBusinessParams(n,{downpayment:s}),i=M(r.downplaymentInputState,void 0,!0),e.deals.setInDeal(n,{downplaymentInputState:i}),e.deals.setIsLoadingItemized(n,{downpayment:!1});case 10:case"end":return t.stop()}}),t)})))()},requestApproval:function(n,a){return Object(b.a)(p.a.mark((function t(){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return W((r=a.deals.deals.find((function(e){return e.businessParams.dealId===n}))).businessParams),t.next=4,e.approvals.requestApproval(r);case 4:case"end":return t.stop()}}),t)})))()},finalizeDeal:function(n,a){return Object(b.a)(p.a.mark((function t(){var r,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0===(null===(r=q(n)(a).approval)||void 0===r?void 0:r.isApproved)){t.next=3;break}throw new Error("Attempt to finalize deal without approval.");case 3:return e.deals.setIsLoadingItemized(n,{isDealFinalized:!0}),t.next=6,k.finalizeFinancing(r.approvalToken);case 6:s=t.sent,e.deals.setInBusinessParams(n,{isDealFinalized:s}),e.deals.setIsLoadingItemized(n,{isDealFinalized:!1});case 9:case"end":return t.stop()}}),t)})))()},setCurrncyAndReloadExchangeRate:function(n,a){return Object(b.a)(p.a.mark((function t(){var r,s,i,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(f.a)(n,2),s=r[0],i=r[1],re(a,s),e.deals.mergeWithGuard(s,ee(te,{businessParams:{downpaymentCurrency:i},isLoadingItemized:{exchangeRate:!0}})),t.next=5,D.getExchangeRate(i);case 5:c=t.sent,e.deals.mergeWithGuard(s,ee(te,{exchangeRate:c,isLoadingItemized:{exchangeRate:!1}}));case 7:case"end":return t.stop()}}),t)})))()}}}}),ue={currentDate:new Date,tickIntervalHandle:void 0},oe={clock:Object(u.a)()({state:ue,reducers:{set:function(e,n){return Object.assign(e,n),e}},effects:function(e){return{start:function(n,a){if(void 0!==a.clock.tickIntervalHandle)try{clearInterval(a.clock.tickIntervalHandle)}catch(r){}var t=setInterval((function(){e.clock.set({currentDate:new Date})}),1e3);e.clock.set({tickIntervalHandle:t}),e.clock.set({currentDate:new Date})},stop:function(n,a){return void 0===a.clock.tickIntervalHandle?"already stopped":(clearInterval(a.clock.tickIntervalHandle),e.clock.set({tickIntervalHandle:void 0}),"clock stopped")}}}}),deals:le,approvals:Q},de=Object(u.b)({models:oe,plugins:[Object(o.a)()]});de.dispatch.clock.start(),window.store=de;a(38);var pe=a(26),be=a.n(pe),ve=a(19),fe=a(0),me=function(e){var n,a,t,r,s,i,c;return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("input",Object(C.a)(Object(C.a)({},null!==(n=e.inputAttributes)&&void 0!==n?n:{}),{},{className:(null!==(a=null===(t=e.inputAttributes)||void 0===t?void 0:t.className)&&void 0!==a?a:"")+(e.inputState.isValid?"":" invalid"),value:null!==(r=null!==(s=e.inputState.currentUnsavedValue)&&void 0!==s?s:null===(i=e.modelState)||void 0===i?void 0:i.toString())&&void 0!==r?r:"",placeholder:e.placeholder,disabled:e.disabled,onChange:function(n){return e.onChange(n.target.value)},onBlur:function(n){return e.onBlur()}})),e.inputState.message&&Object(fe.jsx)("div",Object(C.a)(Object(C.a)({},null!==(c=e.messageAttributes)&&void 0!==c?c:{}),{},{children:e.inputState.message}))]})},ge=function(e){var n,a,t,r,s;return e=Object(C.a)(Object(C.a)({},e),{},{getKeyValue:null!==(n=e.getKeyValue)&&void 0!==n?n:function(e){return e.toString()},getDescription:null!==(a=e.getDescription)&&void 0!==a?a:function(e){return e.toString()}}),Object(fe.jsxs)("select",Object(C.a)(Object(C.a)({},null!==(t=e.selectAttributes)&&void 0!==t?t:{}),{},{disabled:e.disabled,value:e.modelState?null===(r=(s=e).getKeyValue)||void 0===r?void 0:r.call(s,e.modelState):"",onChange:function(n){var a=n.target.value,t=e.availableItems.find((function(n){return a===e.getKeyValue(n)}));if(!0===e.hasEmptyOption)e.onSelect(t);else{if(void 0===t)throw new Error;e.onSelect(t)}},children:[e.hasEmptyOption&&Object(fe.jsx)("option",{value:"",children:e.emptyPlaceholder}),e.availableItems.map((function(n){var a=e.getKeyValue(n),t=e.getDescription(n);return Object(fe.jsx)("option",{value:a,children:t},a)}))]}))},je=function(e){var n=Object(l.b)(),a=Object(l.c)((function(n){return q(e.dealId)(n)}));return Object(fe.jsxs)(fe.Fragment,{children:[a.deal.isLoadingItemized.carModelsAvailable?Object(fe.jsx)("div",{className:"car-model-selector-select",children:"Loading"}):Object(fe.jsx)(ge,{selectAttributes:{className:"car-model-selector-select"},emptyPlaceholder:"Please select model",hasEmptyOption:!0,availableItems:a.deal.carModelsAvailable,modelState:a.deal.businessParams.carModelSelected,getKeyValue:function(e){return e.id.toString()},getDescription:function(e){return e.description},disabled:a.isLoadingAny||a.deal.businessParams.isDealFinalized,onSelect:function(a){return n.deals.setInBusinessParams(e.dealId,{carModelSelected:a})}}),Object(fe.jsx)("button",{className:"car-model-selector-refresh-btn",onClick:function(){return n.deals.reloadAvailableCarModels(a.deal.businessParams.dealId)},disabled:a.isLoadingAny||a.deal.businessParams.isDealFinalized,children:"Refresh available models"})]})},he=(a(40),function(e){var n,a,t;return e=Object(C.a)(Object(C.a)({},e),{},{getKeyValue:null!==(n=e.getKeyValue)&&void 0!==n?n:function(e){return e.toString()},getDescription:null!==(a=e.getDescription)&&void 0!==a?a:function(e){return e.toString()}}),Object(fe.jsx)("select",Object(C.a)(Object(C.a)({},null!==(t=e.selectAttributes)&&void 0!==t?t:{}),{},{multiple:!0,disabled:e.disabled,value:e.modelState.map((function(n){return e.getKeyValue(n)})),onChange:function(n){for(var a=n.target.options,t=[],r=0,s=a.length;r<s;r++)a[r].selected&&t.push(a[r].value);var i=e.availableItems.filter((function(n){return t.some((function(a){return a===e.getKeyValue(n)}))}));e.onSelect(i)},children:e.availableItems.map((function(n){var a=e.getKeyValue(n),t=e.getDescription(n);return Object(fe.jsx)("option",{value:a,children:t},a)}))}))}),Ie=function(e){var n=Object(l.b)(),a=Object(l.c)((function(n){return q(e.dealId)(n)}));return Object(fe.jsxs)(fe.Fragment,{children:[a.deal.isLoadingItemized.insurancePlansAvailable?Object(fe.jsx)("div",{className:"insurance-plan-selector-select",children:"Loading"}):Object(fe.jsx)(he,{selectAttributes:{className:"insurance-plan-selector-select"},availableItems:a.deal.insurancePlansAvailable,modelState:a.deal.businessParams.insurancePlansSelected,disabled:a.isLoadingAny,getKeyValue:function(e){return e.type.toString()},getDescription:function(e){return e.description},onSelect:function(a){return n.deals.setInBusinessParams(e.dealId,{insurancePlansSelected:a})}}),Object(fe.jsx)("button",{className:"insurance-plan-selector-refresh-btn",onClick:function(){return n.deals.reloadAvailableInsurancePlans(e.dealId)},disabled:a.isLoadingAny||a.deal.businessParams.isDealFinalized,children:"Refresh available plans"})]})};function Oe(e,n){var a=y.a.duration(y()(e).diff(n));return Math.round(a.asSeconds())}var we=function(e){return Object(fe.jsx)("div",{className:"car-purchase-deal",children:Object(fe.jsx)(ye,Object(C.a)({},e))})},ye=function(e){var n,a=Object(l.c)((function(n){return q(e.dealId)(n)})),t=[].concat(Object(ve.a)(a.deal.messages),Object(ve.a)(a.generalValidation.downpaymentExceedsPrice?["Downpayment can't exceed total price."]:[]),Object(ve.a)(!1===(null===(n=a.approval)||void 0===n?void 0:n.isApproved)?[a.approval.message]:[])),r=Object(l.b)();return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("div",{className:"car-purchase-model-selector-label",children:"Please select model"}),Object(fe.jsx)(je,{dealId:e.dealId}),Object(fe.jsx)("div",{className:"car-purchase-insurance-selector-label",children:"Please select insurance options"}),Object(fe.jsx)(Ie,{dealId:e.dealId}),Object(fe.jsx)("div",{className:"car-purchase-downpayment-label",children:"Please select downpayment"}),Object(fe.jsx)(me,{inputAttributes:{className:"car-purchase-downpayment"},messageAttributes:{className:"car-purchase-downpayment-messages"},modelState:a.deal.businessParams.downpayment,inputState:a.deal.downplaymentInputState,disabled:a.deal.isLoadingItemized.downpayment||a.deal.businessParams.isDealFinalized,onChange:function(n){return r.deals.updateDownpaymentInputValue(e.dealId,n)},onBlur:function(){return r.deals.tryCommitDownpaymentInputValue(e.dealId)}}),Object(fe.jsx)("button",{className:"button-set-minimum-possible-downpayment",disabled:a.isLoadingAny||!a.canRequestMinimumDownpayment,onClick:function(){return r.deals.setMinimumPossibleDownpayment(e.dealId)},children:"Set minimum possible"}),Object(fe.jsx)("div",{className:"car-purchase-final-price-label",children:"Final price"}),Object(fe.jsx)("div",{className:"car-final-price",children:a.finalPrice}),"no-approval"!==a.dealProgressState&&Object(fe.jsx)(Pe,{dealId:e.dealId}),Object(fe.jsx)("button",{className:"button-request-approval",disabled:a.isLoadingAny||a.isCurrentApprovalLoading||!a.canRequestApproval,onClick:function(){return r.deals.requestApproval(e.dealId)},children:"Request approval"}),Object(fe.jsx)("button",{className:"button-close-active-deal",onClick:function(){return r.deals.removeDeal(e.dealId)},children:"Close this deal"}),Object(fe.jsx)("button",{className:"button-finalzie-deal",disabled:a.deal.isLoadingItemized.isDealFinalized||!a.canBeFinalized,onClick:function(){return r.deals.finalizeDeal(e.dealId)},children:"Finalize deal"}),t.length>0&&Object(fe.jsx)("div",{className:"car-purchase-messages",children:t.map((function(e){return Object(fe.jsx)("div",{children:e},e)}))})]})};function Pe(e){var n=Object(l.c)((function(n){return function(e,n){if("deal-finalized"===e)return"Congratulations! Deal is finalized.";if("no-approval"===e)return"";if("approval-perpetual"===e)return"Approval granted.";if("approval-expired"===e)return"Approval expired.";return"Approval granted. Expires in ".concat(Oe(e.approvalExpiresAt,n)," seconds.")}(q(e.dealId)(n).dealProgressState,n.clock.currentDate)}));return Object(fe.jsx)("div",{className:"car-purchase-deal-state",children:n})}a(41);var xe=function(e){var n=Object(l.c)((function(n){return se(e.dealId)(n)})),a=Object(l.b)();return Object(fe.jsxs)("div",{className:"car-purchase-deal car-purchase-deal-with-foreign-currency",children:[Object(fe.jsx)(ye,{dealId:e.dealId}),Object(fe.jsx)("div",{className:"car-purchase-downpayment-currency-label",children:"Please select currency"}),Object(fe.jsx)(ge,{selectAttributes:{className:"car-purchase-downpayment-currency"},hasEmptyOption:!1,availableItems:n.deal.currenciesAvailable,modelState:n.deal.businessParams.downpaymentCurrency,disabled:n.isLoadingAny||n.deal.businessParams.isDealFinalized,onSelect:function(n){return a.deals.setCurrncyAndReloadExchangeRate([e.dealId,n])}})]})},De=function(){var e=Object(l.c)((function(e){return e.deals})),n=Object(l.c)((function(e){var n;return null===(n=e.deals.deals.find((function(n){return n.businessParams.dealId===e.deals.activeDealId})))||void 0===n?void 0:n.type})),a=Object(l.b)();return Object(fe.jsxs)("div",{id:"app-root",children:[Object(fe.jsx)("div",{className:"main-logo",children:"Hetman Motors (Rematch 2 advanced)"}),Object(fe.jsxs)("div",{className:"screens",children:[Object(fe.jsxs)("div",{className:"tabs",children:[Object(fe.jsx)("button",{className:"button-add-new-deal",disabled:e.newDealIsLoading,onClick:a.deals.loadNewDeal,children:"Add deal"}),Object(fe.jsx)("button",{className:"button-add-new-deal",disabled:e.newDealIsLoading,onClick:a.deals.loadNewDealForeignCurrency,children:"Add foreign currency deal"}),e.deals.filter((function(e){return!e.isClosed})).map((function(e){return Object(fe.jsx)(Se,{dealId:e.businessParams.dealId},e.businessParams.dealId)}))]}),Object(fe.jsx)("div",{className:"active-tab",children:function(e,n){if("undefined"===typeof e)return Object(fe.jsx)(fe.Fragment,{});if(n===ne)return Object(fe.jsx)(xe,{dealId:e});return Object(fe.jsx)(we,{dealId:e})}(e.activeDealId,n)})]})]})},Se=function(e){var n=Object(l.c)((function(n){var a=q(e.dealId)(n);if(!a.deal.businessParams.carModelSelected)return"blank deal";var t="";return"deal-finalized"===a.dealProgressState?t="done":"approval-perpetual"===a.dealProgressState?t="approved":"string"!==typeof a.dealProgressState&&(t="".concat(Oe(a.dealProgressState.approvalExpiresAt,n.clock.currentDate)," sec")),"".concat(a.deal.businessParams.carModelSelected.description," ").concat(a.headerAdditionalDescription).concat(t)})),a=Object(l.b)();return Object(fe.jsxs)("div",{className:be()({"deal-tab-header":!0,active:e.dealId===Object(l.c)((function(e){return e.deals.activeDealId}))}),children:[Object(fe.jsx)("div",{className:"header-text",onClick:function(){return a.deals.set({activeDealId:e.dealId})},children:n}),Object(fe.jsx)("button",{className:"close-button",onClick:function(){return a.deals.removeDeal(e.dealId)},children:"X"})]},e.dealId)},Ae=function(){return Object(fe.jsx)(l.a,{store:de,children:Object(fe.jsx)(De,{})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(fe.jsx)(s.a.StrictMode,{children:Object(fe.jsx)(Ae,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.c9933603.chunk.js.map